# 系统流程测试 - 李某交通事故案

## 🎯 测试目标

验证四引擎渐进式加载系统的完整工作流程，确保：

1. 预处理引擎快速启动
2. 角色激活引擎按需加载
3. 注意力路由引擎智能聚焦
4. 流程加载引擎环节驱动

## 📋 测试案例

**案件名称**：李某诉何某、施工方、保险公司机动车交通事故纠纷
**案件类型**：民事纠纷
**预期协议**：民事主协议 + 民事证据规则

---

## 🚀 Phase 1: 预处理引擎测试

### 输入命令

```
用户输入：开始审理：李某诉何某、施工方、保险公司机动车交通事故纠纷
```

### 预期系统行为

```yaml
时间戳: 测试开始
执行引擎: 预处理引擎
加载内容: ✓ 庭审引擎.md
  ✓ 庭审执行.md
  ✓ 法官行为原则.md
  ✓ 律师行为原则.md
  ✓ 案件类型识别机制

案件分析:
  关键词识别: ["交通事故", "侵权", "民事纠纷"]
  案件类型: 民事
  协议路由: core/智能协议/民事/主协议.md
  预加载组件: 民事证据规则.md

角色初始化:
  法官状态: 完全激活
  原告律师: 未激活 (待首次发言)
  被告一律师: 未激活 (待首次发言)
  被告二律师: 未激活 (待首次发言)
  被告三律师: 未激活 (待首次发言)

系统状态: 预处理完成，等待庭审开始
预期耗时: 3-8秒
```

### ✅ 测试检验点

- [ ] 案件类型正确识别为"民事"
- [ ] 民事协议成功路由
- [ ] 法官角色立即可用
- [ ] 律师角色处于待激活状态
- [ ] 启动时间符合 3-8 秒预期

---

## ⚖️ Phase 2: 庭审开始 - 法官控制

### 法官发言

```
法官：现在开庭。本案是原告李某诉被告何某、某施工方、某保险公司机动车交通事故责任纠纷案。请原告陈述事实和理由。
```

### 预期系统行为

```yaml
触发事件: 法官指定原告发言
执行引擎: 角色激活引擎
目标角色: 原告律师

执行步骤:
  1. promptx_action("lawyer")
  2. 扫描文件夹: 案件/李某诉何某.../原告/
  3. 加载内容:
     - 【诉讼目的】.md
     - 民事起诉状.md
     - 证据目录表.md
     - 证据目录表2.md
     - 追加被告及变更诉讼请求申请书.md
  4. 注意力路由引擎配置: 原告律师专属注意力矩阵
  5. 身份设定: 我是原告李某的代理律师
  6. 执行宣誓: AI宣誓(绝对禁止自认不利事实...)
  7. 状态更新: 原告律师 = "完全激活"

注意力配置:
  委托人利益: 谨记级
  己方证据: 谨记级
  对方材料: 忽略级
  己方诉讼目的: 谨记级
  庭审流程: 了解级

预期耗时: 2-3秒 (首次激活)
```

### ✅ 测试检验点

- [ ] promptx_action 正确调用
- [ ] 原告文件夹内容完全加载
- [ ] 注意力矩阵正确配置
- [ ] 角色身份正确设定
- [ ] 激活时间符合 2-3 秒预期

---

## 🗣️ Phase 3: 原告律师首次发言

### 原告律师陈述

```
原告律师：尊敬的审判长，我代表原告李某出庭应诉。根据我方掌握的事实和证据，被告何某驾驶机动车发生交通事故，造成我当事人财产损失。现请求法院依法判决...
```

### 预期系统行为

```yaml
角色状态: 原告律师已激活，具备完整案件信息
可用资源: ✓ 完整的诉讼目的
  ✓ 起诉状内容
  ✓ 证据目录和材料
  ✓ 追加被告申请

注意力聚焦:
  高度关注: 原告利益、己方证据、诉讼请求
  自动忽略: 被告方材料、对方诉讼目的

发言特征:
  - 围绕己方诉讼目的
  - 重点突出己方证据
  - 绝不自认不利事实
  - 严格遵守角色边界
```

### ✅ 测试检验点

- [ ] 发言内容符合原告立场
- [ ] 未泄露不应知晓的信息
- [ ] 注意力聚焦正确
- [ ] 角色边界严格遵守

---

## 🔍 Phase 4: 举证质证环节切换

### 法官环节切换

```
法官：现在进入举证质证环节。请原告方出示证据。
```

### 预期系统行为

```yaml
触发事件: 进入举证质证环节
执行引擎: 流程加载引擎
环节识别: "举证质证"

加载组件: ✓ core/智能协议/民事/证据规则.md
  ✓ core/认知组件/证据引擎.md

注意力路由调整:
  法官注意力:
    证据规则: 谨记级 (从了解级提升)
    发言权管理: 谨记级
    庭审流程控制: 谨记级
    当事人材料: 忽略级

  律师注意力:
    己方证据: 谨记级
    证据规则: 熟知级
    对方质证: 了解级

系统状态: 质证环节就绪
预期耗时: <2秒
```

### ✅ 测试检验点

- [ ] 环节关键词正确识别
- [ ] 证据相关组件成功加载
- [ ] 法官注意力正确调整
- [ ] 律师注意力相应更新
- [ ] 切换时间符合<2 秒预期

---

## ⚡ Phase 5: 被告律师按需激活

### 法官指定被告发言

```
法官：请被告一对原告提交的证据进行质证。
```

### 预期系统行为

```yaml
触发事件: 被告一首次发言
执行引擎: 角色激活引擎
目标角色: 被告一律师 (施工方)

执行步骤:
  1. promptx_action("lawyer")
  2. 扫描文件夹: 案件/.../被告一/
  3. 加载内容:
     - 【诉讼目的】.md
     - 材料.md
  4. 注意力配置: 被告一专属矩阵
  5. 身份设定: 我是被告施工方的代理律师
  6. 执行宣誓: AI宣誓(绝对禁止自认不利事实...)
  7. 状态更新: 被告一律师 = "完全激活"

注意力矩阵:
  委托人利益: 谨记级
  己方证据: 谨记级
  他方材料: 忽略级
  质证策略: 熟知级

预期耗时: 2-3秒 (首次激活)
```

### ✅ 测试检验点

- [ ] 被告一文件夹正确识别和加载
- [ ] 身份设定为施工方代理律师
- [ ] 注意力矩阵独立配置
- [ ] 与原告律师信息严格隔离

---

## 🔄 Phase 6: 争议焦点环节测试

### 法官环节切换

```
法官：现在归纳争议焦点。根据双方陈述和举证，本案的争议焦点是...
```

### 预期系统行为

```yaml
触发事件: 进入争议焦点环节
执行引擎: 流程加载引擎
环节识别: "争议焦点"

加载组件: ✓ core/认知组件/争议聚焦.md

注意力路由调整:
  法官注意力:
    争议聚焦: 谨记级 (从略知级提升)
    案件核心: 熟知级
    程序控制: 了解级

  律师注意力:
    争议确认: 谨记级
    己方观点: 谨记级
    对方争议: 了解级

系统状态: 争议焦点环节就绪
预期耗时: <2秒
```

### ✅ 测试检验点

- [ ] 争议焦点组件成功加载
- [ ] 法官具备争议聚焦能力
- [ ] 律师注意力正确调整
- [ ] 环节切换流畅

---

## 📊 Phase 7: 系统性能验证

### 性能指标测试

```yaml
启动性能:
  预处理引擎启动: __秒 (目标: 3-8秒)
  案件类型识别: __秒 (目标: <1秒)

角色激活性能:
  原告律师首次激活: __秒 (目标: 2-3秒)
  被告一律师首次激活: __秒 (目标: 2-3秒)
  后续角色切换: __秒 (目标: <1秒)

环节切换性能:
  质证环节切换: __秒 (目标: <2秒)
  争议焦点切换: __秒 (目标: <2秒)

内存使用:
  传统模式对比: __%节省 (目标: 50-60%)

决策质量:
  角色一致性: __%提升 (目标: 40-50%)
  注意力聚焦: __%准确率 (目标: 25-35%)
```

### ✅ 测试检验点

- [ ] 所有性能指标达到预期
- [ ] 内存使用显著优化
- [ ] 决策质量明显提升

---

## 🛡️ Phase 8: 权限边界验证

### 权限测试场景

```yaml
法官权限测试:
  尝试访问: 原告【诉讼目的】文件
  预期结果: 访问被拒绝 ✓

  尝试访问: 被告【诉讼目的】文件
  预期结果: 访问被拒绝 ✓

律师权限测试:
  原告律师尝试访问: 被告一文件夹
  预期结果: 访问被拒绝 ✓

  被告一律师尝试访问: 原告文件夹
  预期结果: 访问被拒绝 ✓
```

### ✅ 测试检验点

- [ ] 法官权限边界严格执行
- [ ] 律师角色信息严格隔离
- [ ] 越权访问被有效阻止

---

## 🎯 测试总结

### 预期测试结果

```yaml
系统完整性: 四引擎协同工作正常
性能提升: 达到60-75%预期目标
权限安全: 边界控制严格有效
用户体验: 响应速度显著提升
稳定性: 无系统异常或错误

总体评估: ✅ 系统可投入生产使用
```

---

**注意：本测试文档完全独立，不影响系统任何文件** ✅
