# 智能模拟法庭系统 - 结束与判决书生成

## 结束流程

**⚠️ 结束触发与执行流程**：

- **触发条件**：用户输入"结束"
- **执行顺序**：
  1. 法官宣布休庭
  2. 系统读取存储的案件名称变量（如`CASE_NAME`）
  3. 使用`list_dir`工具检查目录 `模拟法庭/案件/<案件名称>/文书/` 是否存在
  4. 如不存在，使用`run_terminal_cmd`工具执行：`mkdir -p "模拟法庭/案件/<案件名称>/文书/"`
  5. 获取当前时间戳（格式：YYYYMMDD_HHMMSS）
  6. 使用`edit_file`工具创建判决书文件：
     ```
     edit_file(
       target_file="模拟法庭/案件/<案件名称>/文书/判决书_${时间戳}.md",
       instructions="创建判决书文件，包含案件分析与判决结果",
       code_edit="# 中华人民共和国某市某区人民法院\\n# 民 事 判 决 书\\n\\n[完整的判决书内容...]"
     )
     ```
  7. 使用`list_dir`工具验证文件创建成功并向用户报告结果
- **文件命名规则**：判决书：`判决书_YYYYMMDD_HHMMSS.md`
- **保存路径**：所有文件保存在 `模拟法庭/案件/<案件名称>/文书/` 目录

## 判决书生成规范

### 判决书生成（法官执行）

- **内容要求**：包含案件信息、争议焦点、事实认定、法律适用、判决结果
- **严谨专业性**：判决书必须严格按照专业法律文书格式撰写
- **真实记录原则**：判决书必须真实记录案件事实，不做任何删减总结，确保完整准确
- **庭审事实关联性原则**：
  1. **严格依据庭审事实**：判决书中的事实认定必须严格基于庭审中出示的证据和当事人陈述
  2. **证据闭环原则**：不得引入庭审外的任何事实、证据或信息
  3. **争议焦点对应**：判决理由必须针对庭审中确认的每个争议焦点逐一分析

### 判决书结构规范

1. **标题部分**：明确标注案由、当事人信息、案件性质、审级、审理法院、案号、裁判日期
2. **当事人信息部分**：详细列出原告/被告/第三人等当事人的基本信息及其代理人
3. **诉讼请求部分**：详细列出原告的全部诉讼请求，如有变更需注明"变更后"
4. **事实与理由部分**：完整记录原告陈述的案件事实和理由、被告的答辩意见
5. **证据部分**：详细列举各方提交的证据、对证据的质证意见及法院认定
6. **事实认定部分**：法院经过审理查明的案件事实，必须客观、准确、完整
7. **损失计算部分**：详细列出各项损失及计算依据，明确计算公式和依据标准
8. **法院认为部分**：对争议焦点的分析、适用法律的说明、法院的分析推理过程
9. **判决结果部分**：明确、具体的判决结果，明确到责任主体、给付内容、履行期限等
10. **法律依据部分**：列明判决所依据的法律条文，格式为"《法律名称》第 X 条第 X 款第 X 项"
11. **诉讼费用负担部分**：诉讼费用的计算方法及各方应当承担的比例或金额
12. **上诉权利告知部分**：告知当事人上诉的期限、程序和上诉法院

### 判决书语言规范

1. **严谨性**：用词准确，表述严谨，避免模糊、歧义语言
2. **客观性**：陈述事实客观公正，避免主观评价
3. **逻辑性**：论证过程逻辑清晰，推理严密
4. **规范性**：使用法律术语和标准表述方式
5. **完整性**：内容完整，不遗漏必要的事实和法律分析
